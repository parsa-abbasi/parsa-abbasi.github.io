<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.6.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><meta name=author content="Parsa Abbasi"><meta name=description content="This project explores the implementation of the InceptionV3 model for signature classification in the UTSig dataset."><link rel=alternate hreflang=en-us href=https://parsa-abbasi.github.io/project/signature-verification-with-cnn/><meta name=theme-color content="#1565c0"><link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.936ccf55564b93dfee1448c2f2ea5398.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu14e12911534d82dc6e859b10a3857b5a_3074_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu14e12911534d82dc6e859b10a3857b5a_3074_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://parsa-abbasi.github.io/project/signature-verification-with-cnn/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@ParsaAbbasi1996"><meta property="twitter:creator" content="@ParsaAbbasi1996"><meta property="og:site_name" content="Parsa Abbasi"><meta property="og:url" content="https://parsa-abbasi.github.io/project/signature-verification-with-cnn/"><meta property="og:title" content="Offline Signature Verification with Convolutional Neural Networks (CNNs) | Parsa Abbasi"><meta property="og:description" content="This project explores the implementation of the InceptionV3 model for signature classification in the UTSig dataset."><meta property="og:image" content="https://parsa-abbasi.github.io/project/signature-verification-with-cnn/featured.jpg"><meta property="twitter:image" content="https://parsa-abbasi.github.io/project/signature-verification-with-cnn/featured.jpg"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-02-22T20:15:00+00:00"><meta property="article:modified_time" content="2023-02-22T20:15:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://parsa-abbasi.github.io/project/signature-verification-with-cnn/"},"headline":"Offline Signature Verification with Convolutional Neural Networks (CNNs)","image":["https://parsa-abbasi.github.io/project/signature-verification-with-cnn/featured.jpg"],"datePublished":"2023-02-22T20:15:00Z","dateModified":"2023-02-22T20:15:00Z","author":{"@type":"Person","name":"Parsa Abbasi"},"publisher":{"@type":"Organization","name":"Parsa Abbasi","logo":{"@type":"ImageObject","url":"https://parsa-abbasi.github.io/media/icon_hu14e12911534d82dc6e859b10a3857b5a_3074_192x192_fill_lanczos_center_3.png"}},"description":"This project explores the implementation of the InceptionV3 model for signature classification in the UTSig dataset."}</script><title>Offline Signature Verification with Convolutional Neural Networks (CNNs) | Parsa Abbasi</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=91caf2294239b88c2b777d4b9e271b68><script src=/js/wowchemy-init.min.613040fe4f2c0f007b4dcb64404201cb.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Parsa Abbasi</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Parsa Abbasi</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#publications><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#presentations><span>Presentations</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class="article article-project"><div class="article-container pt-3"><h1>Offline Signature Verification with Convolutional Neural Networks (CNNs)</h1><div class=article-metadata><span class=article-date>Feb 22, 2023</span></div><div class="btn-links mb-3"><a class="btn btn-outline-primary btn-page-header" href=https://github.com/parsa-abbasi/IUST-Pattern-Recognition/blob/main/3%29%20Offline%20Signature%20Verification%20using%20Deep%20Learning/3%29%20Offline%20Signature%20Verification%20using%20Deep%20Learning.ipynb target=_blank rel=noopener>Code</a></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:720px><div style=position:relative><img src=/project/signature-verification-with-cnn/featured_hu3225ff3832392e780fcc5cc52430a021_65997_720x2500_fit_q75_h2_lanczos.webp width=720 height=720 alt class=featured-image>
<span class=article-header-caption>Created with AI (Bing Image Creator)</span></div></div><div class=article-container><div class=article-style><p>Signature verification has practical applications in various fields, particularly for security, legal, and financial purposes. Deep learning (DL) models have been proved to be promising in recognizing handwritten signatures, with high accuracy. In this expriment, we investigate the use of the InceptionV3, a pre-trained convolutional neural network (CNN), for signature classification.</p><div class="alert alert-note"><div>This project was done as part of the Pattern Recognition course at the Iran University of Science and Technology in the Fall of 2020.</div></div><h2 id=dataset>Dataset</h2><p>The dataset used for this project is called <a href=https://arxiv.org/abs/1603.03235 target=_blank rel=noopener>UTSig</a>, which consists of 115 classes, each belonging to one authentic person. There are 27 genuine signatures per class, 3 opposite-hand signed samples, and 42 simple forgeries. The dataset can be downloaded <a href=https://drive.google.com/drive/u/1/folders/0B0CjHfsXJLLObEZFNVdoMlFIODg target=_blank rel=noopener>from here</a>.</p><p><figure id=figure-a-sample-of-the-utsig-dataset><div class="d-flex justify-content-center"><div class=w-100><img alt="Dataset Sample" srcset="/project/signature-verification-with-cnn/dataset_sample_hud2377853091e863c5c5001e36e5e225d_46182_d27d914a8dead64a11dc67de0c1fda92.webp 400w,
/project/signature-verification-with-cnn/dataset_sample_hud2377853091e863c5c5001e36e5e225d_46182_e0f789903d398e0e26f10c941a38a26c.webp 760w,
/project/signature-verification-with-cnn/dataset_sample_hud2377853091e863c5c5001e36e5e225d_46182_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/project/signature-verification-with-cnn/dataset_sample_hud2377853091e863c5c5001e36e5e225d_46182_d27d914a8dead64a11dc67de0c1fda92.webp width=760 height=154 loading=lazy data-zoomable></div></div><figcaption>A sample of the UTSig dataset.</figcaption></figure></p><p>To start the implementation, the dataset is downloaded and stored in the Google Drive. The genuine signatures were divided into 22 training images and 5 test images for each person and placed in the appropriate subdirectorie.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=err>!</span><span class=n>unzip</span> <span class=s1>&#39;/content/drive/MyDrive/UTSig.zip&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>dataset_path</span> <span class=o>=</span> <span class=s1>&#39;/content/UTSig_Crop/&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># Number of genuine signatures per class (person)</span>
</span></span><span class=line><span class=cl><span class=n>G_num</span> <span class=o>=</span> <span class=mi>27</span>
</span></span><span class=line><span class=cl><span class=c1># Number of forgeries signatures per class (person)</span>
</span></span><span class=line><span class=cl><span class=n>F_num</span> <span class=o>=</span> <span class=mi>45</span>
</span></span><span class=line><span class=cl><span class=c1># Number of classes (persons)</span>
</span></span><span class=line><span class=cl><span class=n>c_num</span> <span class=o>=</span> <span class=mi>115</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>dataset_path</span> <span class=o>+</span> <span class=s1>&#39;genuine&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>dataset_path</span> <span class=o>+</span> <span class=s1>&#39;genuine/train&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>dataset_path</span> <span class=o>+</span> <span class=s1>&#39;genuine/test&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dataset_gen_path</span> <span class=o>=</span> <span class=n>dataset_path</span> <span class=o>+</span> <span class=s1>&#39;genuine/&#39;</span>
</span></span></code></pre></div><h2 id=organizing-the-dataset>Organizing the Dataset</h2><p>We organized the images into the appropriate format for the <code>ImageDataGenerator</code>. We created subdirectories for each class in the genuine directory, with 22 images for training and 5 images for testing per class.</p><ul><li>genuine<ul><li>train<ul><li>class_0<ul><li>0_image_0.png</li><li>0_image_1.png</li><li>&mldr;</li><li>0_image_21.png</li></ul></li><li>class_1</li><li>&mldr;</li><li>class_114</li></ul></li><li>test<ul><li>class_0<ul><li>0_image_22.png</li><li>0_image_23.png</li><li>&mldr;</li><li>0_image_26.png</li></ul></li><li>class_1</li><li>&mldr;</li><li>class_114</li></ul></li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>trange</span><span class=p>(</span><span class=n>c_num</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>class_id</span> <span class=o>=</span> <span class=n>c</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=n>class_id_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>class_id</span><span class=p>)</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>c_num</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Make a subdirectory for this class</span>
</span></span><span class=line><span class=cl>  <span class=n>train_subdirectory</span> <span class=o>=</span> <span class=n>dataset_gen_path</span> <span class=o>+</span> <span class=s1>&#39;/train/class_&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>train_subdirectory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>test_subdirectory</span> <span class=o>=</span> <span class=n>dataset_gen_path</span> <span class=o>+</span> <span class=s1>&#39;/test/class_&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>test_subdirectory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># For each genuine</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>g</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>G_num</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>genuine_id</span> <span class=o>=</span> <span class=n>g</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>genuine_id_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>genuine_id</span><span class=p>)</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>G_num</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=n>file_name</span> <span class=o>=</span> <span class=s1>&#39;C&#39;</span> <span class=o>+</span> <span class=n>class_id_str</span> <span class=o>+</span> <span class=s1>&#39;G&#39;</span> <span class=o>+</span> <span class=n>genuine_id_str</span> <span class=o>+</span> <span class=s1>&#39;.PNG&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>file_path</span> <span class=o>=</span> <span class=n>dataset_path</span> <span class=o>+</span> <span class=n>file_name</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>g</span> <span class=o>&lt;</span> <span class=mi>22</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>dest_path</span> <span class=o>=</span> <span class=n>train_subdirectory</span> <span class=o>+</span> <span class=s1>&#39;/&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;_image_&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>g</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;.png&#39;</span>
</span></span><span class=line><span class=cl>      <span class=n>os</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>dest_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>dest_path</span> <span class=o>=</span> <span class=n>test_subdirectory</span> <span class=o>+</span> <span class=s1>&#39;/&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;_image_&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>g</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;.png&#39;</span>
</span></span><span class=line><span class=cl>      <span class=n>os</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>dest_path</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=preprocessing>Preprocessing</h2><p>We used the Image Data Generator from <code>Keras</code> to preprocess our images. We also applied various augmentation techniques such as rotation, zooming, shifting, and flipping to generate more data and reduce overfitting.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>src_path_train</span> <span class=o>=</span> <span class=n>dataset_gen_path</span> <span class=o>+</span> <span class=s1>&#39;/train/&#39;</span>
</span></span><span class=line><span class=cl><span class=n>src_path_test</span> <span class=o>=</span> <span class=n>dataset_gen_path</span> <span class=o>+</span> <span class=s1>&#39;/test/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>train_datagen</span> <span class=o>=</span> <span class=n>ImageDataGenerator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>rescale</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=mf>255.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>rotation_range</span><span class=o>=</span>  <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>zoom_range</span> <span class=o>=</span> <span class=mf>0.05</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>width_shift_range</span> <span class=o>=</span> <span class=mf>0.05</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>height_shift_range</span> <span class=o>=</span> <span class=mf>0.05</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>shear_range</span> <span class=o>=</span> <span class=mf>0.05</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>horizontal_flip</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>fill_mode</span> <span class=o>=</span> <span class=s2>&#34;nearest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>validation_split</span> <span class=o>=</span> <span class=mf>0.20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>test_datagen</span> <span class=o>=</span> <span class=n>ImageDataGenerator</span><span class=p>(</span><span class=n>rescale</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=mf>255.0</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>batch_size</span> <span class=o>=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=n>target_size</span> <span class=o>=</span> <span class=p>(</span><span class=mi>299</span><span class=p>,</span> <span class=mi>299</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>train_generator</span> <span class=o>=</span> <span class=n>train_datagen</span><span class=o>.</span><span class=n>flow_from_directory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>directory</span> <span class=o>=</span> <span class=n>src_path_train</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>target_size</span> <span class=o>=</span> <span class=n>target_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>color_mode</span> <span class=o>=</span> <span class=s2>&#34;rgb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>batch_size</span> <span class=o>=</span> <span class=n>batch_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>class_mode</span> <span class=o>=</span> <span class=s2>&#34;categorical&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>subset</span> <span class=o>=</span> <span class=s1>&#39;training&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>shuffle</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>valid_generator</span> <span class=o>=</span> <span class=n>train_datagen</span><span class=o>.</span><span class=n>flow_from_directory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>directory</span> <span class=o>=</span> <span class=n>src_path_train</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>target_size</span> <span class=o>=</span> <span class=n>target_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>color_mode</span> <span class=o>=</span> <span class=s2>&#34;rgb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>batch_size</span> <span class=o>=</span> <span class=n>batch_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>class_mode</span> <span class=o>=</span> <span class=s2>&#34;categorical&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>subset</span> <span class=o>=</span> <span class=s1>&#39;validation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>shuffle</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>test_generator</span> <span class=o>=</span> <span class=n>test_datagen</span><span class=o>.</span><span class=n>flow_from_directory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>directory</span> <span class=o>=</span> <span class=n>src_path_test</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>target_size</span> <span class=o>=</span> <span class=n>target_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>color_mode</span> <span class=o>=</span> <span class=s2>&#34;rgb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>batch_size</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>class_mode</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>shuffle</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>     
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>test_true_labels</span> <span class=o>=</span> <span class=n>test_generator</span><span class=o>.</span><span class=n>classes</span>
</span></span></code></pre></div><h2 id=model>Model</h2><p><figure id=figure-the-propsed-model-based-on-inceptionv3><div class="d-flex justify-content-center"><div class=w-100><img alt=InceptionV3 srcset="/project/signature-verification-with-cnn/inception_v3_hu1ba8ba5d6b2f15dda1c844dfebbb3d46_170369_1e61465a65494572c37cd2442b0b08c6.webp 400w,
/project/signature-verification-with-cnn/inception_v3_hu1ba8ba5d6b2f15dda1c844dfebbb3d46_170369_9d810d9e41f217308925202095ea680f.webp 760w,
/project/signature-verification-with-cnn/inception_v3_hu1ba8ba5d6b2f15dda1c844dfebbb3d46_170369_1200x1200_fit_q75_h2_lanczos.webp 1200w" src=/project/signature-verification-with-cnn/inception_v3_hu1ba8ba5d6b2f15dda1c844dfebbb3d46_170369_1e61465a65494572c37cd2442b0b08c6.webp width=760 height=380 loading=lazy data-zoomable></div></div><figcaption>The propsed model based on InceptionV3</figcaption></figure>To classify the signatures, we used the <a href=https://keras.io/api/applications/inceptionv3/ target=_blank rel=noopener>InceptionV3</a> model, which is pre-trained on the ImageNet database to classify images into 1000 object categories. We modified the model by removing the fully-connected layer at the top, setting all layers to be non-trainable, and adding a 2D Global Average Pooling to transform the feature embedding into a single 2048 size vector. We then added a fully connected layer with 1024 neurons, a Dropout layer, and a softmax layer to calculate the score for each of the classes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Loading Inception-V3 model</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>InceptionV3</span><span class=p>(</span><span class=n>include_top</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=s1>&#39;imagenet&#39;</span><span class=p>,</span> <span class=n>input_shape</span><span class=o>=</span><span class=p>(</span><span class=mi>299</span><span class=p>,</span> <span class=mi>299</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Freeze layers</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>layer</span> <span class=ow>in</span> <span class=n>model</span><span class=o>.</span><span class=n>layers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=n>layer</span><span class=o>.</span><span class=n>trainable</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add our classifier to the end of the model</span>
</span></span><span class=line><span class=cl><span class=n>flat1</span> <span class=o>=</span> <span class=n>GlobalAveragePooling2D</span><span class=p>()(</span><span class=n>model</span><span class=o>.</span><span class=n>layers</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>output</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>class1</span> <span class=o>=</span> <span class=n>Dense</span><span class=p>(</span><span class=mi>1024</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)(</span><span class=n>flat1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dropout1</span> <span class=o>=</span> <span class=n>Dropout</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)(</span><span class=n>class1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>output</span> <span class=o>=</span> <span class=n>Dense</span><span class=p>(</span><span class=n>c_num</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;softmax&#39;</span><span class=p>)(</span><span class=n>dropout1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>Model</span><span class=p>(</span><span class=n>inputs</span><span class=o>=</span><span class=n>model</span><span class=o>.</span><span class=n>inputs</span><span class=p>,</span> <span class=n>outputs</span><span class=o>=</span><span class=n>output</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=training-and-evaluation>Training and Evaluation</h2><p>We trained the model on our preprocessed data for 10 epochs, and the validation accuracy was 87.39%. We evaluated the model on the test set and achieved an accuracy of 89.39% and a weighted F1-score of 89.25%.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># As the problem have multi-class we should use categorical_crossentropy loss function</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>loss</span><span class=o>=</span><span class=s1>&#39;categorical_crossentropy&#39;</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;adam&#39;</span><span class=p>,</span> <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>STEP_SIZE_TRAIN</span> <span class=o>=</span> <span class=n>train_generator</span><span class=o>.</span><span class=n>n</span><span class=o>//</span><span class=n>train_generator</span><span class=o>.</span><span class=n>batch_size</span>
</span></span><span class=line><span class=cl><span class=n>STEP_SIZE_VALID</span> <span class=o>=</span> <span class=n>valid_generator</span><span class=o>.</span><span class=n>n</span><span class=o>//</span><span class=n>valid_generator</span><span class=o>.</span><span class=n>batch_size</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model_hist</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>train_generator</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                       <span class=n>steps_per_epoch</span> <span class=o>=</span> <span class=n>STEP_SIZE_TRAIN</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                       <span class=n>validation_data</span> <span class=o>=</span> <span class=n>valid_generator</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                       <span class=n>validation_steps</span> <span class=o>=</span> <span class=n>STEP_SIZE_VALID</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                       <span class=n>epochs</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></div><p><figure id=figure-the-learning-curve-of-the-model><div class="d-flex justify-content-center"><div class=w-100><img alt="Learning Curve" srcset="/project/signature-verification-with-cnn/learning_curve_hu8a592860ba336f59abda5517d1fdb7c2_31865_64478ac4d4f3a769157ce4a9cefeca22.webp 400w,
/project/signature-verification-with-cnn/learning_curve_hu8a592860ba336f59abda5517d1fdb7c2_31865_7ea5c9256f1e48c7430280e2029ffb90.webp 760w,
/project/signature-verification-with-cnn/learning_curve_hu8a592860ba336f59abda5517d1fdb7c2_31865_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/project/signature-verification-with-cnn/learning_curve_hu8a592860ba336f59abda5517d1fdb7c2_31865_64478ac4d4f3a769157ce4a9cefeca22.webp width=712 height=352 loading=lazy data-zoomable></div></div><figcaption>The learning curve of the model</figcaption></figure></p><h2 id=classification--unknown-class>Classification + Unknown Class</h2><p>We added a threshold on the softmax results to consider confidence in our predictions. If the maximum softmax value is less than the defined threshold, we classify the image as an unknown class (class_id=115). This was a post-processing step performed after the model&rsquo;s prediction.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>threshold</span> <span class=o>=</span> <span class=mf>0.40</span>
</span></span><span class=line><span class=cl><span class=n>new_pred_classes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=n>pr</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>pred</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=nb>max</span><span class=p>(</span><span class=n>pr</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>threshold</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>new_pred_classes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>115</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>new_pred_classes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>predicted_class_indices</span><span class=p>[</span><span class=n>index</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>new_pred_classes</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>new_pred_classes</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>In conclusion, using a pre-trained model like InceptionV3 for signature classification can yield high accuracy and F1-scores. Preprocessing the data with augmentation techniques can help generate a more robust model and reduce the chance of overfitting.</p></div><div class=article-tags><a class="badge badge-light" href=/tag/deep-learning/>Deep Learning</a>
<a class="badge badge-light" href=/tag/convolutional-neural-networks/>Convolutional Neural Networks</a>
<a class="badge badge-light" href=/tag/cnn/>CNN</a>
<a class="badge badge-light" href=/tag/inceptionv3/>InceptionV3</a>
<a class="badge badge-light" href=/tag/keras/>Keras</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://parsa-abbasi.github.io/project/signature-verification-with-cnn/&amp;text=Offline%20Signature%20Verification%20with%20Convolutional%20Neural%20Networks%20%28CNNs%29" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://parsa-abbasi.github.io/project/signature-verification-with-cnn/&amp;t=Offline%20Signature%20Verification%20with%20Convolutional%20Neural%20Networks%20%28CNNs%29" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Offline%20Signature%20Verification%20with%20Convolutional%20Neural%20Networks%20%28CNNs%29&amp;body=https://parsa-abbasi.github.io/project/signature-verification-with-cnn/" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://parsa-abbasi.github.io/project/signature-verification-with-cnn/&amp;title=Offline%20Signature%20Verification%20with%20Convolutional%20Neural%20Networks%20%28CNNs%29" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Offline%20Signature%20Verification%20with%20Convolutional%20Neural%20Networks%20%28CNNs%29%20https://parsa-abbasi.github.io/project/signature-verification-with-cnn/" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https://parsa-abbasi.github.io/project/signature-verification-with-cnn/&amp;title=Offline%20Signature%20Verification%20with%20Convolutional%20Neural%20Networks%20%28CNNs%29" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://parsa-abbasi.github.io/><img class="avatar mr-3 avatar-square" src=/authors/parsa_abbasi/avatar_hu9152bc9e12bbe7c31ee5536d39d93f58_710495_270x270_fill_q75_lanczos_center.jpg alt="Parsa Abbasi"></a><div class=media-body><h5 class=card-title><a href=https://parsa-abbasi.github.io/>Parsa Abbasi</a></h5><h6 class=card-subtitle>MSc Student</h6><p class=card-text>He is an AI graduate student with a keen interest in graph neural networks, relational graphs, natural language processing, and deep learning.</p><ul class=network-icon aria-hidden=true><li><a href="mailto:parsa.abbasi1996@gmail.com?subject=Mail%20from%20my%20website"><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/parsa-abbasi target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://stackoverflow.com/users/9346942/parsa-abbasi target=_blank rel=noopener><i class="ai ai-stackoverflow"></i></a></li><li><a href="https://scholar.google.co.uk/citations?user=tKCPWs4AAAAJ" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li><li><a href=https://www.researchgate.net/profile/Parsa-Abbasi-3 target=_blank rel=noopener><i class="ai ai-researchgate"></i></a></li><li><a href=https://www.linkedin.com/in/parsa-abbasi/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a href=https://twitter.com/ParsaAbbasi1996 target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li></ul></div></div><div class="project-related-pages content-widget-hr"></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2023 Me. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.32ee83730ed883becad04bc5170512cc.js></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js type=module></script>
<script src=/en/js/wowchemy.min.85290d887e7fcdd400ccb3ffb9bcd3e3.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>